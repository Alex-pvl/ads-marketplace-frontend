import React from 'react'
import { useNavigate, useLocation } from 'react-router-dom'

const ACTIVE_COLOR = '#1689ff'
const INACTIVE_COLOR = 'rgba(221,221,221,0.4)'

function DashboardIcon({ color }: { color: string }) {
  return (
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
      <path
        d="M4.66667 1.66667C4.09203 1.66667 3.54093 1.89494 3.1346 2.30127C2.72827 2.7076 2.5 3.2587 2.5 3.83333V7.83333C2.5 8.11786 2.55604 8.39961 2.66493 8.66248C2.77381 8.92535 2.93341 9.1642 3.1346 9.3654C3.54093 9.77173 4.09203 10 4.66667 10H7C7.57464 10 8.12574 9.77173 8.53206 9.3654C8.93839 8.95907 9.16667 8.40797 9.16667 7.83333V3.83333C9.16667 3.2587 8.93839 2.7076 8.53206 2.30127C8.12574 1.89494 7.57464 1.66667 7 1.66667H4.66667ZM4.66667 11.6667C4.09203 11.6667 3.54093 11.8949 3.1346 12.3013C2.72827 12.7076 2.5 13.2587 2.5 13.8333V16.1667C2.5 16.7413 2.72827 17.2924 3.1346 17.6987C3.54093 18.1051 4.09203 18.3333 4.66667 18.3333H7C7.57464 18.3333 8.12574 18.1051 8.53206 17.6987C8.93839 17.2924 9.16667 16.7413 9.16667 16.1667V13.8333C9.16667 13.2587 8.93839 12.7076 8.53206 12.3013C8.12574 11.8949 7.57464 11.6667 7 11.6667H4.66667ZM13 1.66667C12.4254 1.66667 11.8743 1.89494 11.4679 2.30127C11.0616 2.7076 10.8333 3.2587 10.8333 3.83333V6.16667C10.8333 6.7413 11.0616 7.2924 11.4679 7.69873C11.8743 8.10506 12.4254 8.33333 13 8.33333H15.3333C15.6179 8.33333 15.8996 8.27729 16.1625 8.16841C16.4254 8.05952 16.6642 7.89992 16.8654 7.69873C17.0666 7.49754 17.2262 7.25869 17.3351 6.99581C17.444 6.73294 17.5 6.4512 17.5 6.16667V3.83333C17.5 3.5488 17.444 3.26706 17.3351 3.00419C17.2262 2.74131 17.0666 2.50246 16.8654 2.30127C16.6642 2.10007 16.4254 1.94048 16.1625 1.83159C15.8996 1.72271 15.6179 1.66667 15.3333 1.66667H13ZM13 10C12.4254 10 11.8743 10.2283 11.4679 10.6346C11.0616 11.0409 10.8333 11.592 10.8333 12.1667V16.1667C10.8333 16.7413 11.0616 17.2924 11.4679 17.6987C11.8743 18.1051 12.4254 18.3333 13 18.3333H15.3333C15.6179 18.3333 15.8996 18.2773 16.1625 18.1684C16.4254 18.0595 16.6642 17.8999 16.8654 17.6987C17.0666 17.4975 17.2262 17.2587 17.3351 16.9958C17.444 16.7329 17.5 16.4512 17.5 16.1667V12.1667C17.5 11.8821 17.444 11.6004 17.3351 11.3375C17.2262 11.0746 17.0666 10.8358 16.8654 10.6346C16.6642 10.4334 16.4254 10.2738 16.1625 10.1649C15.8996 10.056 15.6179 10 15.3333 10H13Z"
        fill={color}
      />
    </svg>
  )
}

function MegaphoneIcon({ color }: { color: string }) {
  return (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path
        d="M24 9.5C23.9991 9.08777 23.8708 8.6859 23.6327 8.34937C23.3947 8.01284 23.0584 7.7581 22.67 7.62C22.5937 7.59519 22.5128 7.58771 22.4332 7.59809C22.3537 7.60847 22.2774 7.63645 22.21 7.68C22.1459 7.72762 22.0935 7.78937 22.0571 7.86048C22.0207 7.93158 22.0012 8.01012 22 8.09V11.92C22.0012 11.9999 22.0207 12.0784 22.0571 12.1495C22.0935 12.2206 22.1459 12.2824 22.21 12.33C22.2771 12.3742 22.3534 12.4026 22.4331 12.413C22.5128 12.4234 22.5938 12.4155 22.67 12.39C23.06 12.2513 23.3974 11.9951 23.6356 11.6565C23.8738 11.318 24.0012 10.9139 24 10.5V9.5ZM20.5 3.5C20.4994 3.24791 20.4349 3.00009 20.3125 2.77972C20.1901 2.55936 20.0137 2.37366 19.8 2.24C18.97 1.71 18.33 2.15 17.08 2.76C13.9772 4.43402 10.5243 5.35546 7 5.45C6.92991 5.44965 6.86053 5.46404 6.79636 5.49223C6.73219 5.52043 6.67467 5.5618 6.62752 5.61366C6.58038 5.66552 6.54466 5.72671 6.52269 5.79327C6.50072 5.85983 6.49299 5.93026 6.5 6V14.59C6.5188 16.1179 6.958 17.6111 7.76943 18.9059C8.58085 20.2006 9.73317 21.2469 11.1 21.93C11.3387 22.048 11.6145 22.0664 11.8667 21.9811C12.119 21.8957 12.327 21.7137 12.445 21.475C12.563 21.2363 12.5814 20.9605 12.4961 20.7083C12.4107 20.456 12.2287 20.248 11.99 20.13C10.9739 19.6258 10.1137 18.8555 9.50083 17.901C8.888 16.9465 8.54556 15.8437 8.51 14.71C11.4985 14.9423 14.408 15.7828 17.06 17.18C18.44 17.83 19 18.18 19.82 17.69C20.0308 17.5524 20.2036 17.3639 20.3224 17.142C20.4413 16.92 20.5023 16.6717 20.5 16.42V3.5ZM5 6C5.00039 5.93301 4.98731 5.86661 4.96155 5.80477C4.93578 5.74293 4.89785 5.6869 4.85 5.64C4.75607 5.54946 4.63046 5.49922 4.5 5.5H3.5C3.04 5.49868 2.58428 5.58831 2.15905 5.76373C1.73381 5.93916 1.34745 6.19692 1.02218 6.52218C0.696915 6.84745 0.439157 7.23381 0.263733 7.65905C0.0883093 8.08428 -0.00131994 8.54 0 9V11C0.00130811 11.4605 0.0934672 11.9162 0.271196 12.341C0.448926 12.7657 0.708731 13.1513 1.03573 13.4755C1.36272 13.7997 1.75048 14.0562 2.17677 14.2303C2.60307 14.4044 3.05953 14.4926 3.52 14.49H4.52C4.6474 14.4849 4.76805 14.4314 4.85727 14.3403C4.94649 14.2492 4.99755 14.1275 5 14V6Z"
        fill={color}
      />
    </svg>
  )
}

function ProfileIcon({ color }: { color: string }) {
  return (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M12 2C13.3132 2 14.6136 2.25866 15.8268 2.76121C17.0401 3.26375 18.1425 4.00034 19.0711 4.92893C19.9997 5.85751 20.7363 6.9599 21.2388 8.17316C21.7414 9.38642 22 10.6868 22 12C22 17.5229 17.5229 22 12 22C6.47719 22 2 17.5229 2 12C2 6.47719 6.47719 2 12 2ZM13 13H11C8.52431 13 6.39886 14.4994 5.48213 16.6398C6.93263 18.6737 9.31144 20 12 20C14.6886 20 17.0674 18.6737 18.5179 16.6396C17.6012 14.4994 15.4757 13 13 13ZM12 5C10.3432 5 9 6.34317 9 8C9 9.65686 10.3432 11 12 11C13.6568 11 15 9.65686 15 8C15 6.34317 13.6569 5 12 5Z"
        fill={color}
      />
    </svg>
  )
}

const tabIcons: Record<string, React.FC<{ color: string }>> = {
  main: DashboardIcon,
  'my-ads': MegaphoneIcon,
  profile: ProfileIcon,
}

const tabs = [
  { id: 'main', label: 'Main', path: '/main', matchPaths: ['/main'] },
  { id: 'my-ads', label: 'My ads', path: '/my-ads', matchPaths: ['/my-ads'] },
  { id: 'profile', label: 'Profile', path: '/profile', matchPaths: ['/profile', '/channels'] },
]

export default function NavBar() {
  const navigate = useNavigate()
  const location = useLocation()

  const activeTab = tabs.find(t =>
    t.matchPaths.some(p => location.pathname.startsWith(p))
  )?.id

  return (
    <div className="absolute bottom-0 left-0 right-0 flex justify-center pb-2 pointer-events-none" style={{ zIndex: 100 }}>
      <div
        className="absolute bottom-0 left-0 right-0 h-44 pointer-events-none"
        style={{ background: 'linear-gradient(to top, #111 20%, transparent 100%)' }}
      />
      <div
        className="relative pointer-events-auto flex items-center p-1 rounded-full"
        style={{ background: '#161616', width: 239, height: 62 }}
      >
        {tabs.map(tab => {
          const isActive = tab.id === activeTab
          const IconComponent = tabIcons[tab.id]
          return (
            <button
              key={tab.id}
              onClick={() => navigate(tab.path)}
              className="flex flex-col items-center justify-center gap-1 rounded-full transition-all flex-1"
              style={{
                height: 54,
                background: isActive ? '#313132' : 'transparent',
              }}
            >
              <IconComponent color={isActive ? ACTIVE_COLOR : INACTIVE_COLOR} />
              <span
                style={{
                  fontSize: 10,
                  fontWeight: 500,
                  fontFamily: 'Inter, sans-serif',
                  color: isActive ? ACTIVE_COLOR : INACTIVE_COLOR,
                  lineHeight: '12px',
                }}
              >
                {tab.label}
              </span>
            </button>
          )
        })}
      </div>
    </div>
  )
}
